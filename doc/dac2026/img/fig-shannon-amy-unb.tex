\Qcircuit @C=0.5em @R=0.2em @!R { \\
          \push{{x}_{0} }     & & \multigate{5}{F}            & \qw  & \qw & &         & & \qw               & \qw               & \qw           & \qw                       & \multigate{5}{F_{x_k=1}}    & \qw               & \qw           & \qw                         & \qw           & \qw & \qw               & \qw            & \qw                       & \multigate{5}{F_{x_k=0}}    & \qw               & \qw           & \qw                          & \qw               & \qw\\
          \push{{x}_{1} }     & & \ghost{F}                   & \qw  & \qw & &         & & \qw               & \qw               & \qw           & \qw                       & \ghost{F_{x_k=1}}\qw        & \qw               & \qw           & \qw                         & \qw           & \qw & \qw               & \qw            & \qw                       & \ghost{F_{x_k=1}}           & \qw               & \qw           & \qw                          & \qw               & \qw\\
          \push{\vdots}       & &                             &      & \qw & &         & &                   & \push{\vdots}     &               &  \push{\vdots}            &                             & \push{\vdots}     &               &                             & \push{\vdots} &     &                   &                &  \push{\vdots}            &                             & \push{\vdots}     &               &                              & \push{\vdots}     &    \\
          \push{{x}_{k} }     & & \ghost{F}                   & \qw  & \qw & &         & & \qw               & \qw               & \ctrl{3}      & \qw                       & \ghost{F_{x_k=1}}\qw        & \qw               & \ctrl{3}      & \qw                         & \qw           & \qw & \gate{X}          & \ctrl{3}       & \qw                       & \ghost{F_{x_k=1}}\qw        & \qw               & \ctrl{3}      & \qw                          & \gate{X}          & \qw\\
          \push{\vdots}       & &                             &      & \qw & &\push{=} & &                   & \push{\vdots}     &               & \push{\vdots}             &                             & \push{\vdots}     &               &                             & \push{\vdots} &     &                   &                &  \push{\vdots}            &                             & \push{\vdots}     &               &                              & \push{\vdots}     &    \\
          \push{{x}_{n} }     & & \ghost{F}                   & \qw  & \qw & &         & & \qw               & \qw               & \qw           & \qw                       & \ghost{F_{x_k=1}}\qw        & \qw               & \qw           & \qw                         & \qw           & \qw & \qw               & \qw            & \qw                       & \ghost{F_{x_k=1}}\qw        & \qw               & \qw           & \qw                          & \qw               & \qw\\
          \push{{\ket{0}}   } & & \push{\rtoftarg}\qw\qwx[-1] & \qw  & \qw & &         & & \gate{\mathrm{H}} & \gate{\mathrm{T}} & \targ         & \gate{\mathrm{T^\dagger}} & \push{\rtoftarg}\qw\qwx[-1] & \gate{\mathrm{T}} & \targ         & \gate{\mathrm{T^{\dagger}}} & \qw           & \qw & \gate{\mathrm{T}} & \targ          & \gate{\mathrm{T^\dagger}} & \push{\rtoftarg}\qw\qwx[-1] & \gate{\mathrm{T}} & \targ         & \gate{\mathrm{T^{\dagger}}}  & \gate{\mathrm{H}} & \qw\\
}
%                              & &                             &      &     & &         & & \push{g_1}        & \push{g_2}        & \push{g_3}    & \push{g_4}                & \push{g_5}                  & \push{g_6}        & \push{g_7}    & \push{g_8}                  &               &     & \push{g_9}        & \push{g_{10}}  & \push{g_{11}}             & \push{g_{12}}               & \push{g_{13}}     & \push{g_{14}} & \push{g_{15}}                & \push{g_{16}}     & \\
