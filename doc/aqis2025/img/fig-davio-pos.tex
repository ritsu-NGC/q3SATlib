\Qcircuit @C=0.5em @R=0.2em @!R { \\
                              & &                             &      &     & &         & & \push{\phantom{g_1}}        &     & \push{\phantom{g_2}}        & \push{\phantom{g_3}}        & \push{\phantom{g_4}}     & \push{\phantom{g_5}}                & \push{\phantom{g_6}}                                & \push{\phantom{g_7}}        & \push{\phantom{g_8}}    & \push{\phantom{g_9}}                   & \push{\phantom{g_{10}}}                            & \push{\phantom{g_{11}}}     &    \\
          \push{{x}_{0} }     & & \multigate{5}{F}            & \qw  & \qw & &         & & \multigate{5}{F_{x_k=0}}    & \qw & \qw               & \qw               & \qw            & \qw                       & \multigate{5}{F_{x_k=0} \oplus F_{x_k=1}} & \qw               & \qw           & \qw                          & \multigate{5}{F_{x_k=0} \oplus F_{x_k=1}}& \qw               & \qw\\
          \push{{x}_{1} }     & & \ghost{F}                   & \qw  & \qw & &         & & \ghost{F_{x_k=0}}           & \qw & \qw               & \qw               & \qw            & \qw                       & \ghost{F_{x_k=0} \oplus F_{x_k=1}}        & \qw               & \qw           & \qw                          & \ghost{F_{x_k=0} \oplus F_{x_k=1}}\qw    & \qw               & \qw\\
          \push{\vdots}       & &                             &      &     & &         & &                             &     &                   &                   &                &  \push{\vdots}            &                                           & \push{\vdots}     &               &                              &                                          & \push{\vdots}     &    \\
          \push{{x}_{k} }     & & \ghost{F}                   & \qw  & \qw & &         & & \ghost{F_{x_k=0}}           & \qw & \qw               & \qw               & \ctrl{3}       & \qw                       & \ghost{F_{x_k=0} \oplus F_{x_k=1}}\qw     & \qw               & \ctrl{3}      & \qw                          & \ghost{F_{x_k=0} \oplus F_{x_k=1}}\qw    & \qw               & \qw\\
          \push{\vdots}       & &                             &      &     & &\push{=} & &                             &     &                   &                   &                &  \push{\vdots}            &                                           & \push{\vdots}     &               &                              &                                          & \push{\vdots}     &    \\
          \push{{x}_{n} }     & & \ghost{F}                   & \qw  & \qw & &         & & \ghost{F_{x_k=0}}           & \qw & \qw               & \qw               & \qw            & \qw                       & \ghost{F_{x_k=0} \oplus F_{x_k=1}}\qw     & \qw               & \qw           & \qw                          & \ghost{F_{x_k=0} \oplus F_{x_k=1}}\qw    & \qw               & \qw\\
          \push{{\ket{0}}   } & & \push{\rtoftarg}\qw\qwx[-1] & \qw  & \qw & &         & & \push{\rtoftarg}\qw\qwx[-1] & \qw & \gate{\mathrm{H}} & \gate{\mathrm{T}} & \targ\qwx[-1]  & \gate{\mathrm{T^\dagger}} & \push{\rtoftarg}\qw\qwx[-1]               & \gate{\mathrm{T}} & \targ\qwx[-1] & \gate{\mathrm{T^{\dagger}}}  & \push{\rtoftarg}\qw\qwx[-1]              & \gate{\mathrm{H}} & \qw\\
                              & &                             &      &     & &         & & \push{g_1}                  &     & \push{g_2}        & \push{g_3}        & \push{g_4}     & \push{g_5}                & \push{g_6}                                & \push{g_7}        & \push{g_8}    & \push{g_9}                   & \push{g_{10}}                            & \push{g_{11}}     &    \\
                              & &                             &      &     & &         & &                             &     &                   &                   &                &                           & \push{x_k \cdot (F_{x_k = 0} \oplus F_{x_k = 1})}\gategroup{2}{10}{10}{20}{.7em}{--}  && &                    &                                          &                   &    \\          
}
